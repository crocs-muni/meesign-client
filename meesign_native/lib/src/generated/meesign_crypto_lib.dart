// AUTO GENERATED FILE, DO NOT EDIT.
//
// Generated by `package:ffigen`.
// ignore_for_file: type=lint
import 'dart:ffi' as ffi;

/// Bindings to meesign-crypto C API
class MeeSignCryptoLib {
  /// Holds the symbol lookup function.
  final ffi.Pointer<T> Function<T extends ffi.NativeType>(String symbolName)
      _lookup;

  /// The symbols are looked up in [dynamicLibrary].
  MeeSignCryptoLib(ffi.DynamicLibrary dynamicLibrary)
      : _lookup = dynamicLibrary.lookup;

  /// The symbols are looked up with [lookup].
  MeeSignCryptoLib.fromLookup(
      ffi.Pointer<T> Function<T extends ffi.NativeType>(String symbolName)
          lookup)
      : _lookup = lookup;

  void buffer_free(
    Buffer buffer,
  ) {
    return _buffer_free(
      buffer,
    );
  }

  late final _buffer_freePtr =
      _lookup<ffi.NativeFunction<ffi.Void Function(Buffer)>>('buffer_free');
  late final _buffer_free = _buffer_freePtr.asFunction<void Function(Buffer)>();

  void error_free(
    ffi.Pointer<ffi.Char> error,
  ) {
    return _error_free(
      error,
    );
  }

  late final _error_freePtr =
      _lookup<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ffi.Char>)>>(
          'error_free');
  late final _error_free =
      _error_freePtr.asFunction<void Function(ffi.Pointer<ffi.Char>)>();

  Buffer protocol_serialize(
    ffi.Pointer<Protocol> proto_ptr,
  ) {
    return _protocol_serialize(
      proto_ptr,
    );
  }

  late final _protocol_serializePtr =
      _lookup<ffi.NativeFunction<Buffer Function(ffi.Pointer<Protocol>)>>(
          'protocol_serialize');
  late final _protocol_serialize = _protocol_serializePtr
      .asFunction<Buffer Function(ffi.Pointer<Protocol>)>();

  ffi.Pointer<Protocol> protocol_deserialize(
    ffi.Pointer<ffi.Uint8> ctx_ptr,
    int ctx_len,
  ) {
    return _protocol_deserialize(
      ctx_ptr,
      ctx_len,
    );
  }

  late final _protocol_deserializePtr = _lookup<
      ffi.NativeFunction<
          ffi.Pointer<Protocol> Function(
              ffi.Pointer<ffi.Uint8>, ffi.UintPtr)>>('protocol_deserialize');
  late final _protocol_deserialize = _protocol_deserializePtr.asFunction<
      ffi.Pointer<Protocol> Function(ffi.Pointer<ffi.Uint8>, int)>();

  ffi.Pointer<Protocol> protocol_keygen(
    int proto_id,
    ffi.Pointer<ffi.Uint8> certs_ptr,
    int certs_len,
    ffi.Pointer<ffi.Uint8> pkcs12_ptr,
    int pkcs12_len,
    bool with_card,
    int shares,
  ) {
    return _protocol_keygen(
      proto_id,
      certs_ptr,
      certs_len,
      pkcs12_ptr,
      pkcs12_len,
      with_card,
      shares,
    );
  }

  late final _protocol_keygenPtr = _lookup<
      ffi.NativeFunction<
          ffi.Pointer<Protocol> Function(
              ffi.Int32,
              ffi.Pointer<ffi.Uint8>,
              ffi.UintPtr,
              ffi.Pointer<ffi.Uint8>,
              ffi.UintPtr,
              ffi.Bool,
              ffi.UintPtr)>>('protocol_keygen');
  late final _protocol_keygen = _protocol_keygenPtr.asFunction<
      ffi.Pointer<Protocol> Function(int, ffi.Pointer<ffi.Uint8>, int,
          ffi.Pointer<ffi.Uint8>, int, bool, int)>();

  Buffer protocol_advance(
    ffi.Pointer<Protocol> proto_ptr,
    int index,
    ffi.Pointer<ffi.Uint8> data_ptr,
    int data_len,
    ffi.Pointer<ffi.Pointer<ffi.Char>> error_out,
  ) {
    return _protocol_advance(
      proto_ptr,
      index,
      data_ptr,
      data_len,
      error_out,
    );
  }

  late final _protocol_advancePtr = _lookup<
      ffi.NativeFunction<
          Buffer Function(
              ffi.Pointer<Protocol>,
              ffi.UintPtr,
              ffi.Pointer<ffi.Uint8>,
              ffi.UintPtr,
              ffi.Pointer<ffi.Pointer<ffi.Char>>)>>('protocol_advance');
  late final _protocol_advance = _protocol_advancePtr.asFunction<
      Buffer Function(ffi.Pointer<Protocol>, int, ffi.Pointer<ffi.Uint8>, int,
          ffi.Pointer<ffi.Pointer<ffi.Char>>)>();

  Buffer protocol_finish(
    ffi.Pointer<Protocol> proto_ptr,
    ffi.Pointer<ffi.Pointer<ffi.Char>> error_out,
  ) {
    return _protocol_finish(
      proto_ptr,
      error_out,
    );
  }

  late final _protocol_finishPtr = _lookup<
      ffi.NativeFunction<
          Buffer Function(ffi.Pointer<Protocol>,
              ffi.Pointer<ffi.Pointer<ffi.Char>>)>>('protocol_finish');
  late final _protocol_finish = _protocol_finishPtr.asFunction<
      Buffer Function(
          ffi.Pointer<Protocol>, ffi.Pointer<ffi.Pointer<ffi.Char>>)>();

  ffi.Pointer<Protocol> protocol_init(
    int proto_id,
    ffi.Pointer<ffi.Uint8> group_ptr,
    int group_len,
    ffi.Pointer<ffi.Uint8> certs_ptr,
    int certs_len,
    ffi.Pointer<ffi.Uint8> pkcs12_ptr,
    int pkcs12_len,
    int shares,
  ) {
    return _protocol_init(
      proto_id,
      group_ptr,
      group_len,
      certs_ptr,
      certs_len,
      pkcs12_ptr,
      pkcs12_len,
      shares,
    );
  }

  late final _protocol_initPtr = _lookup<
      ffi.NativeFunction<
          ffi.Pointer<Protocol> Function(
              ffi.Int32,
              ffi.Pointer<ffi.Uint8>,
              ffi.UintPtr,
              ffi.Pointer<ffi.Uint8>,
              ffi.UintPtr,
              ffi.Pointer<ffi.Uint8>,
              ffi.UintPtr,
              ffi.UintPtr)>>('protocol_init');
  late final _protocol_init = _protocol_initPtr.asFunction<
      ffi.Pointer<Protocol> Function(int, ffi.Pointer<ffi.Uint8>, int,
          ffi.Pointer<ffi.Uint8>, int, ffi.Pointer<ffi.Uint8>, int, int)>();

  void auth_key_free(
    AuthKey key,
  ) {
    return _auth_key_free(
      key,
    );
  }

  late final _auth_key_freePtr =
      _lookup<ffi.NativeFunction<ffi.Void Function(AuthKey)>>('auth_key_free');
  late final _auth_key_free =
      _auth_key_freePtr.asFunction<void Function(AuthKey)>();

  AuthKey auth_keygen(
    ffi.Pointer<ffi.Char> name,
    ffi.Pointer<ffi.Pointer<ffi.Char>> error_out,
  ) {
    return _auth_keygen(
      name,
      error_out,
    );
  }

  late final _auth_keygenPtr = _lookup<
      ffi.NativeFunction<
          AuthKey Function(ffi.Pointer<ffi.Char>,
              ffi.Pointer<ffi.Pointer<ffi.Char>>)>>('auth_keygen');
  late final _auth_keygen = _auth_keygenPtr.asFunction<
      AuthKey Function(
          ffi.Pointer<ffi.Char>, ffi.Pointer<ffi.Pointer<ffi.Char>>)>();

  Buffer auth_cert_key_to_pkcs12(
    ffi.Pointer<ffi.Uint8> key_ptr,
    int key_len,
    ffi.Pointer<ffi.Uint8> cert_ptr,
    int cert_len,
    ffi.Pointer<ffi.Pointer<ffi.Char>> error_out,
  ) {
    return _auth_cert_key_to_pkcs12(
      key_ptr,
      key_len,
      cert_ptr,
      cert_len,
      error_out,
    );
  }

  late final _auth_cert_key_to_pkcs12Ptr = _lookup<
      ffi.NativeFunction<
          Buffer Function(
              ffi.Pointer<ffi.Uint8>,
              ffi.UintPtr,
              ffi.Pointer<ffi.Uint8>,
              ffi.UintPtr,
              ffi.Pointer<ffi.Pointer<ffi.Char>>)>>('auth_cert_key_to_pkcs12');
  late final _auth_cert_key_to_pkcs12 = _auth_cert_key_to_pkcs12Ptr.asFunction<
      Buffer Function(ffi.Pointer<ffi.Uint8>, int, ffi.Pointer<ffi.Uint8>, int,
          ffi.Pointer<ffi.Pointer<ffi.Char>>)>();

  Buffer encrypt(
    ffi.Pointer<ffi.Uint8> msg_ptr,
    int msg_len,
    ffi.Pointer<ffi.Uint8> key_ptr,
    int key_len,
    ffi.Pointer<ffi.Pointer<ffi.Char>> error_out,
  ) {
    return _encrypt(
      msg_ptr,
      msg_len,
      key_ptr,
      key_len,
      error_out,
    );
  }

  late final _encryptPtr = _lookup<
      ffi.NativeFunction<
          Buffer Function(
              ffi.Pointer<ffi.Uint8>,
              ffi.UintPtr,
              ffi.Pointer<ffi.Uint8>,
              ffi.UintPtr,
              ffi.Pointer<ffi.Pointer<ffi.Char>>)>>('encrypt');
  late final _encrypt = _encryptPtr.asFunction<
      Buffer Function(ffi.Pointer<ffi.Uint8>, int, ffi.Pointer<ffi.Uint8>, int,
          ffi.Pointer<ffi.Pointer<ffi.Char>>)>();
}

abstract class ProtocolId {
  static const int Gg18 = 0;
  static const int Elgamal = 1;
  static const int Frost = 2;
  static const int Musig2 = 3;
}

abstract class Recipient {
  static const int Unknown = 0;
  static const int Card = 1;
  static const int Server = 2;
}

final class Protocol extends ffi.Opaque {}

final class Buffer extends ffi.Struct {
  external ffi.Pointer<ffi.Uint8> ptr;

  @ffi.UintPtr()
  external int len;

  @ffi.Int32()
  external int rec;
}

final class AuthKey extends ffi.Struct {
  external Buffer key;

  external Buffer csr;
}

const int KEYGEN_ROUNDS = 6;

const int DECRYPT_ROUNDS = 2;

const int SIGN_ROUNDS = 3;
